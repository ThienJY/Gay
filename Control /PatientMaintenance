package Control;

//@author Yung Ka Leong 24SMR06234

import ADT.*;
import Entity.Patient;
import Utility.PatientFile;
import Boundary.PatientMaintenanceUI;

public class PatientMaintenance {
    private ListInterface<Patient> patientList = new List<>();
    private PatientFile patientFile = new PatientFile();
    private PatientMaintenanceUI UI = new PatientMaintenanceUI();
    
    public PatientMaintenance(){
        patientList = patientFile.readFromFile();
        if(!patientList.isEmpty()){
            patientList.getEntry(1).changeNextIdNumber(patientList.getEntry(patientList.getNumberOfEntries()));
        }
    }
    
    public void testPatientMaintenance(){
        int select;
        while(true){
            select = UI.getMenuSelect();
            
            switch(select){
                case 1:
                    patientRegister();
                    break;
                case 2:
                    System.out.println();
                    System.out.println("*** The first patient details ***");
                    viewPatientDetail(getFirstPatient());
                    break;
                case 3:
                    System.out.println();
                    System.out.println("*** Removed patient details ***");
                    viewPatientDetail(removeFirstPatient());
                    break;
                case 4:
                    patientFile.saveToFile(patientList);
                    System.out.println("Exit...");
                    System.exit(0);
                default:
                    System.out.println("-- Unknown Option! Please select again. --");
                    break;
            }
        }
    }
    
    public void addNewPatient(Patient newPatient){
        patientList.add(newPatient);
        patientFile.saveToFile(patientList);
        
        System.out.println("New Patient was added in the Queuing");
    }
    
    public void patientRegister(){
        Patient newPatient = UI.newPatientDetail();
        
        System.out.println();
        System.out.println("*** Patient Details ***");
        viewPatientDetail(newPatient);
        boolean isConfirm = UI.getConfirm();
        
        if(isConfirm){
            addNewPatient(newPatient);
        }
        else{
            System.out.println("The Registration is Cancel.");
        }
    }
    
    public Patient removeFirstPatient(){
        Patient removedPatient = patientList.remove(1);
        patientFile.saveToFile(patientList);
        return removedPatient;
    }
    
    public Patient getFirstPatient(){
        return patientList.getEntry(1);
    }
    
    public void viewPatientDetail(Patient givenPatient){
        if(givenPatient != null){
            System.out.println(givenPatient.toString());
        }
        else{
            System.out.println("-- The patient object is empty! --");
        }
    }
    
    public void reportSummary(){
        if(patientList.isEmpty()){
            System.out.println("-- The patient list is empty! --");
        }
        else{
            System.out.println("*** Summary of the Patient Queue ***");
            for(int i = 1; i <= patientList.getNumberOfEntries(); i++){
                Patient p = patientList.getEntry(i);
                System.out.printf("%d. %s [%s], Age: %d", 
                    i, p.getName(), p.getGender(), p.getAge());
            }
        }
        
    }
    
    public static void main(String[] args){
        PatientMaintenance patientM = new PatientMaintenance();
        patientM.testPatientMaintenance();
    }
}
